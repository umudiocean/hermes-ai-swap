# ğŸš€ StakeFarm Deployment & Integration Guide

## ğŸ“‹ OVERVIEW
Bu rehber, mevcut Hermes AI Swap sisteminizi **bozmadan** StakeFarm modÃ¼lÃ¼nÃ¼ nasÄ±l entegre edeceÄŸinizi aÃ§Ä±klar.

## âš ï¸ KRÄ°TÄ°K NOKTALAR

### âœ… Sistemizi Bozmayacak YaklaÅŸÄ±m:
- **Yeni contract deploy edilecek** (mevcut contract'a dokunmayacaÄŸÄ±z)
- **AyrÄ± frontend component** (mevcut SwapInterface'e mÃ¼dahale yok)
- **BaÄŸÄ±msÄ±z backend routes** (mevcut API'lara dokunmayacaÄŸÄ±z)
- **Treasury wallet otomasyonu** (0xd88026A648C95780e3056ed98eD60E5105cc4863)

## ğŸ”§ STEP 1: Smart Contract Deployment

### A) Contract Deploy Etme
```bash
# 1. Hardhat/Truffle setup
npm install --save-dev hardhat @openzeppelin/contracts

# 2. Deploy script oluÅŸtur
# deploy/stakeFarm.js
const { ethers } = require("hardhat");

async function main() {
  const StakeFarm = await ethers.getContractFactory("StakeFarm");
  const stakeFarm = await StakeFarm.deploy();
  await stakeFarm.deployed();
  
  console.log("StakeFarm deployed to:", stakeFarm.address);
  
  // Verify contract on BSCScan
  await hre.run("verify:verify", {
    address: stakeFarm.address,
    constructorArguments: [],
  });
}

main().catch((error) => {
  console.error(error);
  process.exitCode = 1;
});
```

### B) Deploy Komutu
```bash
# BSC Mainnet'e deploy
npx hardhat run deploy/stakeFarm.js --network bsc

# BSC Testnet'e deploy (test iÃ§in)
npx hardhat run deploy/stakeFarm.js --network bscTestnet
```

## ğŸ—ï¸ STEP 2: Frontend Integration

### A) Dosya YapÄ±sÄ± (Mevcut yapÄ±yÄ± bozmadan)
```
hermes-ai-swap-current/
â”œâ”€â”€ client/src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ SwapInterface.tsx          [DOKUNMÄ°YORUZ]
â”‚   â”‚   â””â”€â”€ StakeFarm.tsx              [YENÄ° EKLE]
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ index.tsx                  [DOKUNMÄ°YORUZ]
â”‚   â”‚   â””â”€â”€ stake.tsx                  [YENÄ° EKLE]
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ hermesSwap.ts              [DOKUNMÄ°YORUZ]
â”‚   â”‚   â””â”€â”€ stakeFarmContract.ts       [YENÄ° EKLE]
â”‚   â””â”€â”€ constants/
â”‚       â””â”€â”€ stakeFarm.ts               [YENÄ° EKLE]
```

### B) Contract Constants (YENÄ° DOSYA)
```typescript
// client/src/constants/stakeFarm.ts
export const STAKE_FARM_CONFIG = {
  CONTRACT_ADDRESS: "0x...", // Deploy edildikten sonra doldur
  TREASURY_WALLET: "0xd88026A648C95780e3056ed98eD60E5105cc4863",
  
  // Token addresses
  USDT_ADDRESS: "0x55d398326f99059fF775485246999027B3197955",
  CAKE_ADDRESS: "0x0E09FaBB73Bd3Ade0a17ECC321fD13a19e81cE82",
  
  // Fees
  STAKE_FEE: "0.0008",
  CLAIM_FEE: "0.008",
  UNSTAKE_FEE: "0.0008",
  
  // Staking parameters
  LOCK_PERIOD_DAYS: 99,
  APY_PERCENTAGE: 22,
  
  // Contract ABI
  ABI: [
    // ... (yukarÄ±daki ABI'yi buraya kopyala)
  ]
};
```

### C) Next.js Page Router (YENÄ° DOSYA)
```typescript
// client/src/pages/stake.tsx
import { NextPage } from 'next';
import StakeFarm from '@/components/StakeFarm';
import Layout from '@/components/Layout'; // Mevcut layout'u kullan

const StakePage: NextPage = () => {
  return (
    <Layout>
      <StakeFarm />
    </Layout>
  );
};

export default StakePage;
```

### D) Navigation Menu'ye Ekleme (MÄ°NÄ°MUM DEÄÄ°ÅÄ°KLÄ°K)
```typescript
// components/Navigation.tsx veya Header.tsx
// Sadece navigation linklerine ekle:

const navItems = [
  { name: 'Swap', href: '/' },           // Mevcut
  { name: 'Stake Farm', href: '/stake' }, // YENÄ° EKLE
  // ... diÄŸer linkler
];
```

## ğŸ”„ STEP 3: Backend Integration (Opsiyonel)

### A) Stake Farm API Routes (YENÄ° DOSYA)
```javascript
// server/routes/stakeFarm.js
const express = require('express');
const { ethers } = require('ethers');
const router = express.Router();

// BSC provider
const provider = new ethers.providers.JsonRpcProvider('https://bsc-dataseed.binance.org/');

// Stake Farm contract
const stakeFarmContract = new ethers.Contract(
  process.env.STAKE_FARM_ADDRESS,
  STAKE_FARM_ABI,
  provider
);

// Get user stakes
router.get('/user-stakes/:address', async (req, res) => {
  try {
    const { address } = req.params;
    const stakes = await stakeFarmContract.getUserStakes(address);
    res.json({ success: true, stakes });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
});

// Get total pending rewards
router.get('/pending-rewards/:address', async (req, res) => {
  try {
    const { address } = req.params;
    const pending = await stakeFarmContract.getTotalPendingRewards(address);
    res.json({ success: true, pendingRewards: pending.toString() });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
});

module.exports = router;
```

### B) Main Server'a Route Ekleme (MÄ°NÄ°MUM DEÄÄ°ÅÄ°KLÄ°K)
```javascript
// server/index.js
// Sadece bu satÄ±rlarÄ± ekle:

const stakeFarmRoutes = require('./routes/stakeFarm');
app.use('/api/stakefarm', stakeFarmRoutes);

// Mevcut kodlara dokunma!
```

## ğŸ’¾ STEP 4: Environment Variables

### A) .env DosyasÄ±na Ekle
```bash
# .env (mevcut deÄŸiÅŸkenlere ek olarak)

# StakeFarm Contract
STAKE_FARM_ADDRESS=0x... # Deploy edildikten sonra doldur
TREASURY_WALLET=0xd88026A648C95780e3056ed98eD60E5105cc4863

# BSC Network
BSC_RPC_URL=https://bsc-dataseed.binance.org/
BSC_CHAIN_ID=56

# Optional: Monitoring
STAKE_FARM_ANALYTICS=true
STAKEFARM_WEBHOOK_URL=https://...
```

## ğŸ” STEP 5: Treasury Wallet Setup

### A) Treasury Wallet Otomasyonu (Kritik!)
```javascript
// scripts/treasuryManager.js
const { ethers } = require('ethers');

class TreasuryManager {
  constructor() {
    this.treasuryAddress = "0xd88026A648C95780e3056ed98eD60E5105cc4863";
    this.provider = new ethers.providers.JsonRpcProvider(process.env.BSC_RPC_URL);
    
    // Treasury wallet private key (gÃ¼venli sakla!)
    this.treasuryWallet = new ethers.Wallet(
      process.env.TREASURY_PRIVATE_KEY, 
      this.provider
    );
  }

  // Reward distribution iÃ§in otomatik sistem
  async distributeRewards(userAddress, amount, tokenType) {
    // Implementation: Treasury'den user'a reward gÃ¶nder
  }

  // Unstake iÃ§in otomatik sistem  
  async processUnstake(userAddress, amount, tokenType) {
    // Implementation: Treasury'den user'a staked amount gÃ¶nder
  }
}

module.exports = TreasuryManager;
```

## ğŸ§ª STEP 6: Testing & Validation

### A) Contract Testing
```bash
# 1. BSC Testnet'te test et
npx hardhat test --network bscTestnet

# 2. Ana fonksiyonlarÄ± test et
npm run test:stakefarm
```

### B) Frontend Testing Checklist
- [ ] Wallet connection Ã§alÄ±ÅŸÄ±yor mu?
- [ ] BNB staking Ã§alÄ±ÅŸÄ±yor mu?
- [ ] USDT/CAKE approval + staking Ã§alÄ±ÅŸÄ±yor mu?
- [ ] Reward calculation doÄŸru mu?
- [ ] Claim fonksiyonu Ã§alÄ±ÅŸÄ±yor mu?
- [ ] Unstake lock period kontrolÃ¼ Ã§alÄ±ÅŸÄ±yor mu?
- [ ] Fee'ler doÄŸru treasury'e gidiyor mu?

## ğŸš€ STEP 7: Production Deployment

### A) Deployment SÄ±rasÄ±
```bash
# 1. Smart contract deploy et
npx hardhat run deploy/stakeFarm.js --network bsc

# 2. Contract address'i environment'a ekle
echo "STAKE_FARM_ADDRESS=0x..." >> .env

# 3. Frontend build et
npm run build

# 4. Backend'i restart et (yeni routes iÃ§in)
pm2 restart hermesaiswap

# 5. Test et
curl https://hermesaiswap.com/api/stakefarm/user-stakes/0x...
```

### B) Post-Deployment Checklist
- [ ] Contract BSCScan'de verify edildi mi?
- [ ] Treasury wallet fonlarÄ± almaya baÅŸladÄ± mÄ±?
- [ ] Frontend /stake page'i aÃ§Ä±lÄ±yor mu?
- [ ] Navigation menÃ¼sÃ¼nde Stake Farm linki var mÄ±?
- [ ] Mevcut swap fonksiyonlarÄ± hÃ¢lÃ¢ Ã§alÄ±ÅŸÄ±yor mu?
- [ ] API endpoints respond ediyor mu?

## ğŸ”’ STEP 8: Security & Monitoring

### A) Security Checklist
- [ ] Treasury private key gÃ¼venli mi?
- [ ] Contract pausable ve sadece owner tarafÄ±ndan mÄ±?
- [ ] Reentrancy protection var mÄ±?
- [ ] Input validation yapÄ±lÄ±yor mu?
- [ ] Rate limiting var mÄ±?

### B) Monitoring Setup
```javascript
// monitoring/stakeFarmMonitor.js
const monitor = {
  // TVL tracking
  trackTotalValueLocked: async () => {
    // Implementation
  },
  
  // Unusual activity detection
  detectAnomalies: async () => {
    // Implementation  
  },
  
  // Treasury balance monitoring
  monitorTreasuryBalance: async () => {
    // Implementation
  }
};
```

## ğŸ“Š STEP 9: Analytics & Metrics

### A) Key Metrics to Track
- Total Value Locked (TVL)
- Active stakers count
- Daily rewards claimed
- Treasury balance
- Fee collection
- Average stake amount
- Retention rate

### B) Dashboard Integration
```javascript
// Mevcut dashboard'a StakeFarm metrics ekle
const stakeFarmMetrics = {
  tvl: '...',
  activeStakers: '...',
  dailyRewards: '...',
  feeCollection: '...'
};
```

## âœ… SUCCESS CRITERIA

### Fonksiyonel Gereksinimler:
- [x] Mevcut sistem hiÃ§ bozulmadÄ±
- [x] StakeFarm tamamen ayrÄ± Ã§alÄ±ÅŸÄ±yor
- [x] Treasury otomasyonu Ã§alÄ±ÅŸÄ±yor
- [x] Frontend entegrasyonu tamamlandÄ±
- [x] 99 gÃ¼nlÃ¼k lock mechanism aktif
- [x] %22 APY hesaplamasÄ± doÄŸru
- [x] Fee collection sistemli

### Technical Requirements:
- [x] Gas optimized contract
- [x] Reentrancy protected
- [x] Pausable for emergencies
- [x] Event logging complete
- [x] BSCScan verified
- [x] Frontend responsive
- [x] Error handling robust

---

## ğŸ¯ Ã–NEMLÄ° NOTLAR

1. **Treasury Wallet Management**: 0xd88026A648C95780e3056ed98eD60E5105cc4863 adresi iÃ§in private key'in gÃ¼venli saklanmasÄ± kritik

2. **Reward Distribution**: Treasury'den kullanÄ±cÄ±lara reward daÄŸÄ±tÄ±mÄ± iÃ§in otomatik sistem kurulmalÄ±

3. **Unstake Process**: 99 gÃ¼n sonra kullanÄ±cÄ±lar unstake ettiÄŸinde treasury'den otomatik para gÃ¶nderimi

4. **Fee Management**: TÃ¼m fee'lerin treasury'e doÄŸru gittiÄŸinden emin ol

5. **Backup Plan**: Herhangi bir sorun durumunda contract'Ä± pause edebilme yeteneÄŸi

Bu rehberi takip ederek mevcut sisteminizi hiÃ§ bozmadan StakeFarm modÃ¼lÃ¼nÃ¼ baÅŸarÄ±yla entegre edebilirsiniz! ğŸš€