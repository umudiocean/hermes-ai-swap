# ğŸš€ HermesReswapV2 Sistem Ã‡alÄ±ÅŸma KÄ±lavuzu

## ğŸ“‹ Platform Ã–zeti
**HermesReswapV2**, BSC (Binance Smart Chain) Ã¼zerinde Ã§alÄ±ÅŸan geliÅŸmiÅŸ bir token swap platformudur. Her swap iÅŸleminde kullanÄ±cÄ±lara HERMES token Ã¶dÃ¼lÃ¼ veren ve referans sistemi ile ek kazanÃ§ imkanÄ± sunan bir DeFi protokolÃ¼dÃ¼r.

---

## ğŸ—ï¸ Temel Mimari

### Contract Adresi
```
0x4C7d75909f744D7e69EcDdaCD1840c9A26A4Aa00
```

### Ana BileÅŸenler
- **PancakeSwap Router:** Token swaplarÄ± iÃ§in
- **HERMES Token:** Ã–dÃ¼l sistemi
- **Referral System:** Gelir paylaÅŸÄ±mÄ±
- **Fee Collection:** Platform geliri

---

## ğŸ’° Ekonomik Model

### Platform Ãœcretleri
- **Swap Fee:** 0.0005 BNB (her iÅŸlemde)
- **Destination:** `0xd88026A648C95780e3056ed98eD60E5105cc4863`
- **Transfer:** Otomatik (swap sÄ±rasÄ±nda)

### Ã–dÃ¼l Sistemi

#### ğŸ¯ Referans OLMADAN Swap:
```
KullanÄ±cÄ± â†’ 100,000 HERMES (anÄ±nda)
```

#### ğŸ¤ Referans Ä°LE Swap:
```
Swap Yapan â†’ 90,000 HERMES
Referans Sahibi â†’ 10,000 HERMES
```

---

## ğŸ”„ Swap TÃ¼rleri

### 1. BNB â†’ Token
```solidity
swap(address(0), tokenAddress, 0, referralCode)
```
- **Input:** BNB (msg.value - 0.0005)
- **Output:** Herhangi bir token
- **Fee:** 0.0005 BNB + PancakeSwap fees

### 2. Token â†’ BNB
```solidity
swap(tokenAddress, address(0), amount, referralCode)
```
- **Input:** Token miktarÄ±
- **Output:** BNB
- **Fee:** 0.0005 BNB + PancakeSwap fees

### 3. Token â†’ Token
```solidity
swap(tokenA, tokenB, amount, referralCode)
```
- **Input:** TokenA miktarÄ±
- **Output:** TokenB
- **Route:** TokenA â†’ WBNB â†’ TokenB
- **Fee:** 0.0005 BNB + PancakeSwap fees

---

## ğŸ« Referans Sistemi DetaylarÄ±

### Referans Kodu OluÅŸturma
```solidity
generateReferralCode() â†’ uint256
```
- Her kullanÄ±cÄ± **1 kez** kod oluÅŸturabilir
- Kodlar **1000**'den baÅŸlar (1000, 1001, 1002...)
- Mapping: `codeToReferrer[kod] = wallet_adresi`

### Referans KullanÄ±mÄ±
```solidity
swap(tokenIn, tokenOut, amount, referralCode)
```

#### Validasyon KurallarÄ±:
1. `referralCode > 0` olmalÄ±
2. Kod **mevcut** olmalÄ± (`codeToReferrer[kod] != address(0)`)
3. Kod sahibi **swap yapan kiÅŸi deÄŸil** olmalÄ±

### Ã–dÃ¼l DaÄŸÄ±tÄ±mÄ± Logic:
```solidity
if (referralCode geÃ§erli) {
    user.transfer(90,000 HERMES)
    referrer.transfer(10,000 HERMES)
} else {
    user.transfer(100,000 HERMES)
}
```

---

## ğŸ› ï¸ Fonksiyon Listesi

### Core Functions

#### `swap(tokenIn, tokenOut, amountIn, referralCode)`
- Ana swap fonksiyonu
- Fee transfer + swap + Ã¶dÃ¼l daÄŸÄ±tÄ±mÄ±
- **Payable:** BNB swap'leri iÃ§in

#### `generateReferralCode()`
- Yeni referans kodu oluÅŸtur
- Return: uint256 (kod numarasÄ±)

### Convenience Functions

#### `swapBNBToHERMES(referralCode)`
- BNB â†’ HERMES direkt swap
- **Payable function**

#### `swapHERMESToBNB(amount, referralCode)`
- HERMES â†’ BNB direkt swap
- **Payable function**

### View Functions

#### `estimateSwap(tokenIn, tokenOut, amountIn)`
- Swap Ã¶ncesi fiyat tahmini
- **Gas optimized**

#### `getReferralCode(address user)`
- KullanÄ±cÄ±nÄ±n referans kodunu getir

#### `getReferralStats(address user)`
- Referans istatistikleri
- Return: `(code, earnings, totalRefs, hasCode)`

#### `getContractInfo()`
- Platform genel bilgileri
- Return: `(hermesBalance, bnbBalance, swapCount, rewardsDistributed, feesCollected, referralRewardsTotal, canReward)`

---

## ğŸ“Š Ä°statistik Tracking

### Global Stats
- `totalSwaps` - Toplam swap sayÄ±sÄ±
- `totalRewardsDistributed` - DaÄŸÄ±tÄ±lan toplam HERMES
- `totalFeesCollected` - Toplanan platform Ã¼cretleri
- `totalReferralRewards` - Referans Ã¶dÃ¼lleri toplamÄ±

### User Stats
- `referralEarnings[user]` - KullanÄ±cÄ±nÄ±n referans kazancÄ±
- `totalReferrals[user]` - KullanÄ±cÄ±nÄ±n toplam referanslarÄ±

---

## ğŸ” GÃ¼venlik Ã–zellikleri

### Access Control
- **Owner-only functions:** Emergency withdraw, token withdraw
- **Public functions:** Swap, referral generation

### Safety Checks
- Fee transfer kontrolÃ¼ (swap Ã¶ncesi)
- Token balance validation
- Referral code validation
- Zero address protection

### Emergency Functions
```solidity
emergencyWithdrawBNB() // Owner only
withdrawToken(token, amount) // Owner only
```

---

## ğŸ¯ KullanÄ±m SenaryolarÄ±

### Senaryo 1: Ä°lk KullanÄ±cÄ± (Referans Yok)
```
1. User: swap(BUSD, BNB, 100, 0)
2. Platform: Fee collect (0.0005 BNB)
3. PancakeSwap: BUSD â†’ BNB swap
4. Platform: 100,000 HERMES â†’ User
5. Result: User gets BNB + 100,000 HERMES
```

### Senaryo 2: Referans ile Swap
```
1. UserA: generateReferralCode() â†’ 1000
2. UserB: swap(BNB, HERMES, 0, 1000)
3. Platform: Fee collect (0.0005 BNB)
4. PancakeSwap: BNB â†’ HERMES swap
5. Platform: 90,000 HERMES â†’ UserB
6. Platform: 10,000 HERMES â†’ UserA
7. Result: Both users get HERMES rewards
```

### Senaryo 3: Ã‡oklu Token Swap
```
1. User: swap(BUSD, USDT, 1000, 1001)
2. Path: BUSD â†’ WBNB â†’ USDT
3. Referrer gets: 10,000 HERMES
4. User gets: USDT + 90,000 HERMES
```

---

## ğŸ“ˆ Business Logic Flow

### 1. Fee Processing
```
msg.value >= 0.0005 BNB âœ“
â†’ Transfer 0.0005 BNB to FEE_COLLECTOR
â†’ Emit FeeCollected & FeeTransferred
```

### 2. Swap Execution
```
Token Type Detection
â†’ Route Selection (direct/indirect)
â†’ PancakeSwap Interaction
â†’ Balance Verification
```

### 3. Reward Distribution
```
HERMES Balance Check
â†’ Referral Validation
â†’ Reward Transfer (90k+10k or 100k)
â†’ Stats Update
```

---

## âš™ï¸ Integration Guide

### Web3 Integration
```javascript
// Contract instance
const contract = new web3.eth.Contract(ABI, CONTRACT_ADDRESS);

// Generate referral code
await contract.methods.generateReferralCode().send({from: account});

// Perform swap with referral
await contract.methods.swap(tokenIn, tokenOut, amount, referralCode).send({
    from: account,
    value: web3.utils.toWei('0.0005', 'ether')
});

// Get user stats
const stats = await contract.methods.getReferralStats(account).call();
```

### Frontend Requirements
1. **Wallet Connection** (MetaMask, WalletConnect)
2. **Token Selection** UI
3. **Referral Code** input/display
4. **Fee Display** (0.0005 BNB + slippage)
5. **Reward Tracking** dashboard

---

## ğŸš¨ Ã–nemli Notlar

### HERMES Token YÃ¶netimi
- Contract'a yeterli HERMES token yÃ¼klenmeli
- `depositRewards(amount)` fonksiyonu ile yÃ¼kleme
- Ã–dÃ¼l verebilmek iÃ§in `balance >= 100,000 HERMES` gerekli

### Fee Handling
- Fee transfer **swap Ã¶ncesi** yapÄ±lÄ±r
- Transfer baÅŸarÄ±sÄ±z olursa tÃ¼m iÅŸlem revert olur
- Fee miktarÄ± **sabit**: 0.0005 BNB

### Referral Restrictions
- KullanÄ±cÄ± kendi referans kodunu kullanamaz
- Referral kodu **bir kez** oluÅŸturulabilir
- GeÃ§ersiz kod durumunda normal Ã¶dÃ¼l (100k) verilir

---

## ğŸ“ Contract Interaction Examples

### Read Functions (No Gas)
```solidity
getContractInfo() // Platform durumu
getReferralCode(user) // User'Ä±n kodu
estimateSwap(tokenA, tokenB, amount) // Fiyat tahmini
```

### Write Functions (Gas Required)
```solidity
generateReferralCode() // Kod oluÅŸtur
swap(tokenIn, tokenOut, amount, refCode) // Ana iÅŸlem
depositRewards(amount) // HERMES yÃ¼kle (owner)
```

Bu sistem sayesinde kullanÄ±cÄ±lar hem token swap yapabilir, hem HERMES Ã¶dÃ¼lÃ¼ kazanabilir, hem de referans sistemi ile pasif gelir elde edebilir. Platform sÃ¼rdÃ¼rÃ¼lebilir bir ekonomik model ile Ã§alÄ±ÅŸÄ±r ve tÃ¼m iÅŸlemler blockchain Ã¼zerinde ÅŸeffaf ÅŸekilde gerÃ§ekleÅŸir.