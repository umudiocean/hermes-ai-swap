# ğŸš€ HermesSwapV3Referral Sistem Ã‡alÄ±ÅŸma KÄ±lavuzu

## ğŸ“‹ Contract Bilgileri
- **Contract Adresi:** `0x040c821072fB0db013453329DcC78aB433d19a31`
- **Contract AdÄ±:** `HermesSwapV3Referral`
- **Network:** BSC Mainnet
- **EVM Version:** Cancun

---

## ğŸ’° Yeni Ã–dÃ¼l Sistemi

### ğŸ¯ Referans OLMADAN Swap:
```
KullanÄ±cÄ± â†’ Swap yapar
Platform â†’ 100,000 HERMES verir
SonuÃ§: 100,000 HERMES (eski sistem ile aynÄ±)
```

### ğŸ¤ Referans Ä°LE Swap (YENÄ°!):
```
KullanÄ±cÄ± â†’ Referans kodu ile swap yapar
Platform â†’ Toplam 120,000 HERMES havuzundan:
â”œâ”€â”€ KullanÄ±cÄ±: 110,000 HERMES alÄ±r
â””â”€â”€ Referans Sahibi: 10,000 HERMES alÄ±r

Toplam DaÄŸÄ±tÄ±m: 120,000 HERMES
```

---

## ğŸ”„ Swap Ä°ÅŸlem AkÄ±ÅŸÄ±

### 1. **Fee Ä°ÅŸlemi (Her Swap'te)**
```
KullanÄ±cÄ± â†’ 0.0005 BNB gÃ¶nderir
Platform â†’ Fee'yi otomatik ÅŸu adrese transfer eder:
           0xd88026A648C95780e3056ed98eD60E5105cc4863
```

### 2. **Token Swap Ä°ÅŸlemi**
```
PancakeSwap Router Ã¼zerinden swap gerÃ§ekleÅŸir:
- BNB â†” Token
- Token â†” Token
- TÃ¼m fee-on-transfer tokenlar desteklenir
```

### 3. **Ã–dÃ¼l DaÄŸÄ±tÄ±mÄ±**
```
IF (referral kodu var ve geÃ§erli)
    Contract â†’ KullanÄ±cÄ±ya 110,000 HERMES
    Contract â†’ Referans sahibine 10,000 HERMES
ELSE
    Contract â†’ KullanÄ±cÄ±ya 100,000 HERMES
```

---

## ğŸ« Referans Sistemi DetaylarÄ±

### Referans Kodu OluÅŸturma:
```solidity
generateReferralCode() â†’ uint256 (kod numarasÄ±)
```
- Her kullanÄ±cÄ± **1 kez** kod oluÅŸturabilir
- Kod numaralarÄ± **1000**'den baÅŸlar
- Sistem otomatik artÄ±rÄ±r: 1000, 1001, 1002...

### Referans KullanÄ±mÄ±:
```solidity
swap(tokenIn, tokenOut, amount, referralCode)
```

#### GeÃ§erlilik KoÅŸullarÄ±:
âœ… Referral kod > 0 olmalÄ±  
âœ… Kod daha Ã¶nce oluÅŸturulmuÅŸ olmalÄ±  
âœ… Kod sahibi swap yapan kiÅŸi olmamalÄ±  

---

## ğŸ”§ Ana Fonksiyonlar

### **Swap Fonksiyonu**
```solidity
function swap(
    address tokenIn,     // GÃ¶nderilecek token (0x0 = BNB)
    address tokenOut,    // AlÄ±nacak token (0x0 = BNB)
    uint256 amountIn,    // Miktar (BNB swap'lerde 0)
    uint256 referralCode // Referans kodu (0 = yok)
) external payable
```

### **Referans Kodu OluÅŸturma**
```solidity
function generateReferralCode() external returns (uint256)
```

### **HÄ±zlÄ± Swap FonksiyonlarÄ±**
```solidity
swapBNBToHERMES(referralCode)   // BNB â†’ HERMES
swapHERMESToBNB(amount, referralCode) // HERMES â†’ BNB
```

---

## ğŸ“Š View FonksiyonlarÄ±

### **KullanÄ±cÄ± Bilgileri**
```solidity
getReferralCode(address user) â†’ uint256
getReferralStats(address user) â†’ (code, earnings, totalRefs, hasCode)
```

### **Platform Bilgileri**
```solidity
getContractInfo() â†’ (
    hermesBalance,      // Contract'taki HERMES miktarÄ±
    bnbBalance,         // Contract'taki BNB miktarÄ±
    swapCount,          // Toplam swap sayÄ±sÄ±
    rewardsDistributed, // DaÄŸÄ±tÄ±lan toplam HERMES
    feesCollected,      // Toplanan toplam fee
    referralRewardsTotal, // Referans Ã¶dÃ¼lleri toplamÄ±
    canReward           // Ã–dÃ¼l verebilir mi?
)
```

### **Fiyat Tahmini**
```solidity
estimateSwap(tokenIn, tokenOut, amountIn) â†’ estimatedOut
```

---

## ğŸ’¡ KullanÄ±m Ã–rnekleri

### Ã–rnek 1: Ä°lk KullanÄ±cÄ± (Referans Yok)
```
1. User: generateReferralCode() â†’ 1000 dÃ¶ner
2. User: swap(BNB, USDT, 0, 0) 
   - 0.001 BNB gÃ¶nderir (0.0005 fee + swap iÃ§in)
3. Platform: 0.0005 BNB fee'yi collector'a gÃ¶nderir
4. PancakeSwap: 0.0005 BNB â†’ USDT swap
5. Platform: 100,000 HERMES â†’ User
```

### Ã–rnek 2: Referans ile Swap
```
1. UserA: generateReferralCode() â†’ 1001 dÃ¶ner
2. UserB: swap(USDT, BNB, 100, 1001)
   - 0.0005 BNB fee gÃ¶nderir
   - 100 USDT approve eder
3. Platform: Fee'yi collector'a gÃ¶nderir
4. PancakeSwap: 100 USDT â†’ BNB swap
5. Platform: 110,000 HERMES â†’ UserB
6. Platform: 10,000 HERMES â†’ UserA (referans sahibi)
```

### Ã–rnek 3: HERMES AlÄ±m/SatÄ±m
```
// HERMES AlÄ±mÄ±
swapBNBToHERMES(1001) 
- BNB â†’ HERMES + referans Ã¶dÃ¼lÃ¼

// HERMES SatÄ±mÄ±  
swapHERMESToBNB(50000 * 10**18, 1001)
- 50,000 HERMES â†’ BNB + referans Ã¶dÃ¼lÃ¼
```

---

## âš¡ Teknik Detaylar

### Gas Optimizasyonu:
- **Cancun EVM** en gÃ¼ncel optimizasyonlar
- **Fee-on-transfer** token desteÄŸi
- **Batch iÅŸlemler** tek transaction'da

### GÃ¼venlik Ã–zellikleri:
- **Automatic fee transfer** (swap Ã¶ncesi)
- **Balance validation** her adÄ±mda
- **Referral validation** Ã§ift kontrol
- **Owner-only** emergency functions

### Swap RotalarÄ±:
```
BNB â†” Token: Direkt yol (2 adÄ±m)
Token A â†” Token B: BNB Ã¼zerinden (3 adÄ±m)
- Token A â†’ WBNB â†’ Token B
```

---

## ğŸ“ˆ Ekonomik Model

### Platform Geliri:
```
Her Swap = 0.0005 BNB fee
â†“
Otomatik Transfer: 0xd88026A648C95780e3056ed98eD60E5105cc4863
```

### Ã–dÃ¼l Havuzu:
```
Referans YOK: 100,000 HERMES/swap
Referans VAR: 120,000 HERMES/swap (20% artÄ±ÅŸ!)
```

### Referans Incentive:
```
KullanÄ±cÄ± KazancÄ±: 110,000 HERMES (10% artÄ±ÅŸ)
Referans Sahibi: 10,000 HERMES (pasif gelir)
```

---

## ğŸ”§ Admin FonksiyonlarÄ±

### HERMES YÃ¼kleme:
```solidity
depositRewards(amount) // HERMES token yÃ¼kle
```

### Acil Durum:
```solidity
emergencyWithdrawBNB() // Owner only
withdrawToken(token, amount) // Owner only
```

---

## ğŸ¯ Ä°statistikler ve Tracking

### Global Ä°statistikler:
- `totalSwaps` - Toplam swap sayÄ±sÄ±
- `totalRewardsDistributed` - DaÄŸÄ±tÄ±lan HERMES toplamÄ±
- `totalFeesCollected` - Toplanan BNB fee toplamÄ±
- `totalReferralRewards` - Referans Ã¶dÃ¼lleri toplamÄ±

### KullanÄ±cÄ± Ä°statistikleri:
- `referralEarnings[user]` - KullanÄ±cÄ±nÄ±n referans kazancÄ±
- `totalReferrals[user]` - KullanÄ±cÄ±nÄ±n referans sayÄ±sÄ±

---

## ğŸš¨ Ã–nemli Notlar

### HERMES Token YÃ¶netimi:
- Contract'a yeterli HERMES yÃ¼klenmeli
- Referans swap'leri iÃ§in **120,000 HERMES** gerekli
- Normal swap'ler iÃ§in **100,000 HERMES** gerekli

### Fee Gereksinimleri:
- **Her swap** minimum 0.0005 BNB gerektirir
- Fee transfer baÅŸarÄ±sÄ±z olursa **tÃ¼m iÅŸlem iptal** olur
- Kalan BNB swap iÃ§in kullanÄ±lÄ±r

### Referans Limitleri:
- KullanÄ±cÄ± **kendi kodunu kullanamaz**
- Her kullanÄ±cÄ± **sadece 1 kod** oluÅŸturabilir
- GeÃ§ersiz kod durumunda **normal Ã¶dÃ¼l** (100k) verilir

---

## ğŸŒŸ Yeni Sistemin AvantajlarÄ±

### KullanÄ±cÄ±lar Ä°Ã§in:
âœ… **%10 daha fazla Ã¶dÃ¼l** (90k â†’ 110k HERMES)  
âœ… **Referans geliri** (10k HERMES/referans)  
âœ… **AynÄ± platform fee** (0.0005 BNB)  

### Platform Ä°Ã§in:
âœ… **%20 daha fazla token daÄŸÄ±tÄ±mÄ±** (virality)  
âœ… **GÃ¼Ã§lÃ¼ referral sistemi** (user acquisition)  
âœ… **Stabil gelir** (her swap'te fee)  

---

## ğŸ“ Web3 Integration Ã–rneÄŸi

```javascript
// Contract instance
const contract = new web3.eth.Contract(ABI, CONTRACT_ADDRESS);

// Referral kod oluÅŸtur
const referralCode = await contract.methods.generateReferralCode().send({
    from: userAddress
});

// Referral ile swap yap
await contract.methods.swap(
    tokenInAddress,   // Input token
    tokenOutAddress,  // Output token  
    amountIn,         // Amount
    referralCode      // Referral code
).send({
    from: userAddress,
    value: web3.utils.toWei('0.0005', 'ether') // Fee
});

// KullanÄ±cÄ± stats al
const stats = await contract.methods.getReferralStats(userAddress).call();
console.log(`KazanÃ§: ${stats.earnings} HERMES`);
console.log(`Referans sayÄ±sÄ±: ${stats.totalRefs}`);
```

---

Bu yeni sistem sayesinde hem kullanÄ±cÄ±lar daha fazla Ã¶dÃ¼l kazanacak, hem de referans sistemi ile platform organik olarak bÃ¼yÃ¼yecek! ğŸš€